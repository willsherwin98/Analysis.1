

#========================Factorial analysis=====================================

#Ho1 - Sex will have no effect on size 
#Ho2 - island will have no effect on size
#Ho3 - competition will have no effect on size
#Ho4 - presence and island will have no effect on size 

#Make the variables easier to work with 
Sex <- An.d$sex
SVL <- An.d$svl
Island <- An.d$island
Presence <- An.d$presence

#================Visualize the data============================================
# first view the data in a bar plot 
barplot(tapply(SVL,list(Presence,Sex), mean), beside = T,
        col = c("red","blue","green","pink"), ylim = c(0,80))

#inspect the mean values of our two factors 
tapply(SVL,list(Presence,Sex),mean)
#The means do not significantly differ between islands 

#create a density plot to view the data between sex and island  
ggplot(An.d, aes(x = svl)) + geom_density() + facet_wrap(island ~
                                                                sex)

#now between sex and and presence 
ggplot(An.d, aes(x = svl)) + geom_density() + facet_wrap(presence ~
                                                           sex)

#From the initial visualization of the data it appears that on average males are 
#larger than females but there is no difference between presence and no presence 

#==========================Model the Data======================================
# Now fit a factorial analysis of varience
model <- aov(SVL~Presence  + Sex * Island)
summary.lm(model)

#Try to simplify the model. 
model.s <-  aov(SVL~Presence+Sex+Island)
summary.lm(model.s)

#Model.1 with presence + sex
model.1 <- aov(SVL~Presence+Sex)
summary.lm(model.s)

# model 2 with comp + island 
model.2 <- aov(SVL~Presence+Island)
summary.lm(model.2)

#model 3 effect of comp
model.3 <- aov(SVL~Presence)
summary.lm(model.3)

#model 4 effect of island
model.4 <- aov(SVL~Island)
summary.lm(model.4)

#model 5 effect of sex
model.5 <- aov(SVL~Sex)
summary.lm(model.5)

#=================Determin which model is has an Effect=========================

AIC(model.1,model.2,model.3,model.4,model.5)
#from this we can see that models 1 and 5 have the most effect which makes sense
#because our data does not show any signs of presence or island having an effect 

#=================Run a mixed effect model on the data=========================
#interaction plot to see the interaction between variables 

interaction.plot(Presence,Sex, SVL, fun=mean)
#we can see that presence and mean size of SVL between the sexes have no interaction 

interaction.plot(Island,Sex, SVL, fun=mean)
#same is true with islands. 


#This is so that distributions that must be non-zero can make sense of my
# data
res <- SVL +1 
qqp(res,"norm") # norm distribution fits my data best for in this context. 
# since my data  is normally distributed I can use a linear mixed model

#check lognorm distribuution 
qqp(res,"lnorm")

#Run a LMM
#library(lme4)

lmm.A <- lmer(svl~presence+sex +(1|island), data = An.d, REML = FALSE)

summary(lmm.A)
#we can see that our random effect is not 0 so it has some sort of effect. 

#see the significance 
Anova(lmm.A)
#from this we can see the presence of a congener does not have an effect on SVL 
#and that sex is the main factor that influences SVL in Anole lizards. 



